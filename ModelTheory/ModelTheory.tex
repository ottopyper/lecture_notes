\documentclass[]{article}


\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{parskip}
\usepackage{xcolor}
\usepackage{pagecolor}
\usepackage[margin=1.2in]{geometry}
\usepackage{enumerate}
\usepackage{enumitem}

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usepackage{mathtools}
\DeclarePairedDelimiter\bra{\langle}{\rvert}
\DeclarePairedDelimiter\ket{\lvert}{\rangle}
\DeclarePairedDelimiterX\braket[2]{\langle}{\rangle}{#1 \delimsize\vert #2}

\definecolor{thmcolour}{rgb}{0,0,0}
\definecolor{defcolour}{rgb}{0,0,0}
\definecolor{textcolour}{rgb}{0,0,0}
\definecolor{backgroundcolour}{rgb}{1,1,1}

\pagecolor{backgroundcolour}
\color{textcolour}

\newtheoremstyle{custhm}
{%space above
1em
}{%space below
1em
}{%body font
\color{thmcolour}\em
}{%indent amount
-0em
}{%head font
\bfseries\color{thmcolour}
}{%head punct
}{%after head space
1em
}{%head spec
\thmname{#1}\if\relax\detokenize{#2}\relax:\else\thmnumber{ #2}:\fi\if\relax\detokenize{#3}\relax\else\thmnote{ (#3)}\fi
}

\newtheoremstyle{ex}
{%space above
1em
}{%space below
1em
}{%body font
\color{thmcolour}
}{%indent amount
-0em
}{%head font
\bfseries\color{thmcolour}
}{%head punct
}{%after head space
1em
}{%head spec
\thmname{#1}\if\relax\detokenize{#2}\relax:\else\thmnumber{ #2}:\fi\if\relax\detokenize{#3}\relax\else\thmnote{(#3)}\fi
}

\newtheoremstyle{remark}
{%space above
}{%space below
}{% body font
}{%indent amount
-0em
}{%head font
\bfseries
}{%head punct
}{%after head space
1em
}{%head spec
\if\relax\detokenize{#3}\relax\thmname{#1}:\else\thmname{#3}:\fi
}

\newtheoremstyle{cusdef}
{%space above
1em
}{%space below
1em
}{%body font
\color{defcolour}
}{%indent amount
-0em
}{%head font
\bfseries\color{defcolour}
}{%head punct
}{%after head space
1em
}{%head spec
%if numbered, include number
%if named, include name
\thmname{#1}\if\relax\detokenize{#2}\relax:\else\thmnumber{ #2}:\fi\if\relax\detokenize{#3}\relax\else\thmnote{ (#3)}\fi
}

\theoremstyle{custhm}
\newtheorem{theorem}{Theorem}[section]
\theoremstyle{cusdef}
\newtheorem{defin}[theorem]{Definition}
\theoremstyle{custhm}
\newtheorem{lemma}[theorem]{Lemma}
\theoremstyle{custhm}
\newtheorem{cor}[theorem]{Corollary}

\theoremstyle{custhm}
\newtheorem{prop}[theorem]{Proposition}

\theoremstyle{ex}
\newtheorem{ex}[theorem]{Example}

\theoremstyle{custhm}
\newtheorem*{theorem*}{Theorem}

\theoremstyle{cusdef}
\newtheorem*{defin*}{Definition}

\theoremstyle{remark}
\newtheorem*{remark*}{Remark}


%\marginpar{to describe which lecture it is}

\newcommand{\Na}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\e}{\mathrm{e}}
\newcommand{\ra}{\rightarrow}
\newcommand{\lef}{\left(}
\newcommand{\res}{\right)}
\newcommand{\ie}{\textit{i.e.}}
\newcommand{\eps}{\varepsilon}
\newcommand{\E}{\mathbb{E}}
\newcommand{\suminf}{\sum_{n=0}^{\infty}}
\newcommand{\suminfa}[1]{\sum_{#1=0}^{\infty}}
\renewcommand{\P}{\mathbb{P}}
\newcommand{\undf}[1]{\textit{\textbf{#1}}}
\renewcommand{\L}{\mathcal{L}}
\renewcommand{\it}[1]{\textit{#1}}
\newcommand{\M}{\mathcal{M}}
\renewcommand{\phi}{\varphi}
\newcommand{\proves}{\vdash}
\newcommand{\lra}{\leftrightarrow}
\renewcommand{\value}{|\cdot|}
\newcommand{\val}[1]{\left|#1\right|}
\newcommand{\valk}{(K,|\cdot|)}
\renewcommand{\bar}{\overline}
\renewcommand{\O}{\mathcal{O}}
\newcommand{\Th}{\textrm{Th}}
\newcommand{\tp}{\textrm{tp}}

\renewcommand{\lnot}{\neg}
\newcommand{\false}{\bot}
\newcommand{\true}{\top}
\newcommand{\n}{\mathcal{N}}
\newcommand{\N}{\mathcal{N}}
\newcommand{\ac}[1]{\mathcal{#1}}
\newcommand{\acf}{\textrm{ACF}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\A}{\mathcal{A}}
\newcommand{\rg}{\textrm{RG}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\sman}{S_n^\M(A)}

\title{Model Theory}
\author{Lectures by Gabriel Conant}
\date{}

\begin{document}
	
	\maketitle
	\clearpage
	\tableofcontents
	\clearpage

\marginpar{Lecture 1}
\section{Review of First Order Logic}

A \undf{language} is a set $\L$ of function symbols, relation symbols, and constant symbols. Additionally, each function/relation symbol has an assigned \it{arity} $n\ge 1$.

By convention, we view constant symbols as `function symbols of arity 0'.

An \undf{$\L$-structure} $\mathcal{M}$ consists of:
\begin{itemize}
	\item a non-empty set $M$ (the \undf{universe} of $\mathcal{M}$)
	\item for every function symbol $f$ of arity $n$, a function $f^{\M}:M^n\ra M$
	\item for every relation symbol $R$ of arity $n$, a subset $R^\M\subseteq M^n$
	\item for every constant symbol $c$, an element $c^\M \in M$ (\ie\ identified with the unique element in its image)
\end{itemize}

\undf{Syntax}: we build formulas using symbols in $\L$ along with $$ \land\ \lnot\ \forall\ =\ (\ )\ ,$$and countably many variable symbols.

\undf{$\L$-term}: these are our way of creating new functions by composing the ones we already have.
\begin{itemize}
	\item constant symbols and variables are terms
	\item if $t_1,\dots,t_n$ are terms and $f$ is an $n$-ary function symbol, then $f(t_1,\dots,t_n)$ is a term
\end{itemize}

Given a structure $\M$ and a term $t$, we are going to interpret the term in the structure in exactly the way you might expect. Inductively, define (for appropriate $r$) $t^\M:M^r\ra M$ as:
\begin{itemize}
	\item constant symbol $c$: $c^\M$ (case $r = 0$)
	\item variable $x$: identify function ($r = 1$)
	\item general term $f(t_1,\dots,t_n):\ f^\M(t_1^\M,\dots,t_n^\M)$
\end{itemize}

\undf{$\L$-formulas}: new relations. We have the following \it{atomic} $L$-formulas:
\begin{itemize}
	\item If $t_1$ and $t_2$ are terms, then $(t_1=t_2)$ is a formula
	\item If $R$ is an $n$-ary relation symbol and $t_1,\dots,t_n$ are terms, then $R(t_1,\dots,t_n)$ is a formula
\end{itemize}
We can then create more complicated formulas. Given formulae $\phi$ and $\psi$:
\begin{itemize}
	\item $\lnot\phi$
	\item $(\phi \land \psi)$
	\item $\forall x\phi$ for any variable $x$
\end{itemize}

An occurrence of a variable $x$ is \undf{free} in $\phi$ if $x$ does not occur in the scope of $\forall x$. Otherwise, the occurrence is \undf{bound}.

For instance, if $\phi$ is the statement $\forall x \lnot(f(x)=y)$, $x$ is bound and $y$ is free. 

\undf{Notation}: Given a formula $\phi$, we write $\phi(x_1,\dots,x_n)$ to denote that $x_1,\dots,x_n$ are the free variables of $\phi$.

Given a formula $\phi(x_1,\dots,x_n)$, a structure $\M$, $a_1,\dots,a_n\in M$, we define ``$\bar{a}$ satisfies $\phi$ in $\M$'', written $\M\models\phi(a_1,\dots,a_n)$, as follows:
\begin{itemize}
	\item If $\phi$ is $(t_1 = t_2)$ then $\M\models \phi(\bar{a})$ iff $t_1^\M(\bar{a}) = t_2^\M(\bar{a})$
	\item If $\phi$ is $R(t_1,\dots,t_n)$ then $\M\models\phi(\bar{a})$ iff $(t_1^\M(\bar{a}),\dots,t_n^\M(\bar{a})\in R^\M$
	\item $\M\models (\phi\land\psi)(\bar{a})$ iff $\M \models \phi(\bar{a})$ and $\M\models \psi(\bar{a})$
	\item $\M \models \lnot \phi(\bar{a})$ iff $\M\not\models \phi(\bar{a})$
	\item Suppose $\phi$ is $\forall w \psi(x_1\dots,x_n,w)$. Then $M\models \phi(\bar{a})$ iff for all $b\in M$, $\M\models \psi(\bar{a},b)$
\end{itemize}

We emphasise that the focus of this course will not be on the precise definitions and semantics, so much as the meaning of what we are doing. All we seek is a first order logic that works for us, so that we can use it to do interesting things.

\undf{Abbreviations}: We have \it{global} abbreviations such as
\begin{itemize}
	\item $(\phi\lor\psi)$ is $\lnot(\lnot\phi\land\lnot\psi)$
	\item $(\phi\ra\psi)$ is $(\lnot\phi\lor\psi)$
	\item $(\phi\lra\psi)$ is $(\phi\ra\psi)\land(\psi\ra\phi)$
	\item $\exists x \phi$ is $\lnot\forall x\lnot \phi$
\end{itemize}

We note that the last equivalence in a semantic sense hinges on the assumption that universes are non-empty. Since we will be almost exclusively be studying infinite structures, we will not worry about this.

We also have \it{local} abbreviations, often specific to the language we are studying. For instance, in $\L = \{+,\cdot,<,0,1\}$ (the language of ordered rings):
\begin{itemize}
	\item $x+y$ is $+(x,y)$
	\item $x < y$ is $<(x,y)$
	\item $x \le y$ is $(x<y) \land (x=y)$
	\item $x < y < z$ is $(x < y)\land (y<z)$
	\item $x^2$ is $x\cdot x$
	\item $nx$ is $\underbrace{x+x+\cdots+x}_{n\textrm{ times}}$
\end{itemize}

An \undf{$\L$-sentence} is an $\L$-formula with no free variables. For instance, $\forall x (f(x)\ne y)$ is \it{not} a sentence, but $\exists y\forall x(f(x)\ne y)$ \it{is} a sentence. Sentences can be thought of as actually saying something meaningful.

If $\phi$ is a sentence and $\M$ is a structure, then we have the notion of $\M\models\phi$, ``$\M$ satisfies $\phi$'' or ``$\M$ models $\phi$''.

\begin{defin*}[$L$-theory]
	An \undf{$L$-theory} is a set of $L$-sentences.

Given a theory $T$, we write $\M\models T$ (``$\M$ is a \undf{model} of $T$) if $\M\models\phi$ for all $\phi \in T$.

T is \undf{satisfiable} if it has a model.
\end{defin*}

\undf{Example}: $T = \{\lnot \exists x(x=x)\}$ - this sentence claims there are no elements in the universe. In our setting, this is unsatisfiable (though it is technically a matter of opinion).

Similarly, $\exists x(x=x)$ (``The Axiom of Non-Triviality'') is always satisfied in any $\L$-structure.

\undf{Recall}: $T$ is \undf{consistent} if it does not prove a contradiction (\it{e.g.} $(\phi\land\lnot\phi))$

A consequence of \undf{G{\"o}del's Completeness Theorem} is that a theory is satisfiable iff it is consistent. This is a very important theorem, though we will mostly be focussing on the model theoretic aspect (satisfiability).

\marginpar{Lecture 2}

We now consider a fixed language $\L$.

An $\L$-theory $T$ is \undf{finitely satisfiable} if every finite subset of $T$ is satisfiable. This leads us to one of the most important theorems for getting Model Theory off the ground:

\begin{theorem*}[Compactness Theorem]
An $\L$-theory $T$ satisfiable iff it is finitely satisfiable
\end{theorem*}

Another important theorem of Model Theory is the following.

\begin{theorem*}[Downward Lowenheim-Skolem Theorem]
	Any satisfiable $\L$-theory has a model of cardinality at most $|\L|+\aleph_0$
\end{theorem*}

The proofs of the above are non-examinable; see Part II notes for details.

\begin{theorem*}[(Upward) Lowenheim-Skolem  Theorem]
Suppose $T$ is an $\L$-theory with infinite models. Then $T$ has a model of cardinality $\kappa$ for any $\kappa \ge |\L|+\aleph_0$
\end{theorem*}

We note that by the `cardinality' of a structure we mean the cardinality of its universe.

\begin{proof}
What we need to do here is build a model of this theory, but do it such that it's not just a model of the theory but that it also has some extra properties of our choosing. This is a common technique in model theory.

We want more elements, so we add more symbols to our language and more sentences claiming various properties about these symbols.

Let $\L^\ast = \L \cup \{c_i : i < \kappa\}$ where each $c_i$ is a new constant symbol.

Then let $T^\ast = T\cup \{c_i\ne c_j: i\ne j\}$. Suppose $\Sigma \subset T^\ast$ is finite. Then $\Sigma \subset T\cup\{c_i\ne c_j:i,j\in I\}$ for some finite set $I$.

Let $\M\models T$ be an infinite $\L$-structure. Expand $\M$ to an $\L^{\ast}$ structure $\M^\ast$ by interpreting $c_i^{\M^\ast}$ as distinct elements for $i\in I$, and interpreting $c_i^{\M^\ast}$ for $i\not\in I$ arbitrarily. Note that this is `physically' the same structure, all we have changed is its interpretation.

Then $M^{\ast}\models\Sigma$, so $T$ is finitely satisfiable. Hence by the Compactness Theorem $T^\ast$ is satisfiable. Then by DLST, $T^\ast$ has a model $\mathcal{N}^\ast$ of cardinality at most $|\L^\ast|+\aleph_0 = \kappa$. Moreover, every model has cardinality \it{at least} $\kappa$, so $\mathcal{N}^\ast$ indeed has cardinality $\kappa$.

Then let $\mathcal{N}$ be the reduct of $\mathcal{N}^\ast$ to $\L$ (same universe, different interpretation). Then $\mathcal{N}\models T$ and $|N| = \kappa$.
\end{proof}

\section{Complete Theories}

\begin{defin}[Semantic Entailment]
Let $T$ be an $\L$-theory and $\phi$ an $\L$-sentence. Then $T\models \phi$ (`$T$ \undf{models} $\phi$, `$T$ \undf{implies} $\phi$') if any model of $T$ is also a model of $\phi$.
\end{defin}

\begin{ex}\ 
\begin{enumerate}[label=\arabic*)]
\item $\{\phi,\psi\}\models \phi\land\psi$
\item If $T$ is consistent then $T\models \exists x(x=x)$ (also if it's not consistent). So $\emptyset \models \exists x(x=x)$ since we assume all models are non-empty.
\item Let $T$ be the theory of groups in the language of groups $\L = \{\ast,e\}$.

Then $T\models \forall x\forall y\forall z\left((x\ast y = e\land x\ast z = e)\ra y=z\right)$, since in any group inverses are unique.
\end{enumerate}
\end{ex}

\begin{defin}[Complete Theory]
An $\L$-theory $T$ si \undf{complete} if, for any $\L$-sentence $\phi$, we have $T\models\phi$ or $T\models \neg\phi$.
\end{defin}

\begin{ex}\ 
\begin{enumerate}[label=\arabic*)]
\item The theory of groups is not complete. Consider $\forall x\forall y (x\ast y = y \ast x)$ - this asserts that the group is abelian. Since there are some groups with this property and some without it, then neither $T\models \phi$ nor $T\models \neg\phi$.
\item ZFC is not complete (if it is consistent); consider the Continuum Hypothesis.
\end{enumerate}
\end{ex}

\begin{defin}[Theory of a structure]
	Let $\M$ be an $\L$-structure. The \undf{theory of $\M$} is
	\begin{align*}
	\textrm{Th}(\M) = \textrm{Th}_\L(\M) \coloneqq \{\phi : \phi \textrm{ is an $\L$-sentence and }\M \models \phi\}
	\end{align*}
\end{defin}
Note that $\Th(\M)$ is complete, since for every $\phi$ either $\phi \in \Th(\M)$ or $M\models \not \phi$. However, this makes $\Th(\M)$ complicated as a set; every sentence or its negation is in the set, including many that are pointless or redundant. We want to look for complete theories that have a much more efficient presentation.

\begin{defin}[Elementarily Equivalent]
Two $\L$-structures $\M$ and $\N$ are \undf{elementarily equivalent}, written $\M\equiv \mathcal{N}$ if $\Th(\M) = \Th(\mathcal(N))$.
\end{defin}
Note that $\equiv$ is an equivalence relation on $\L$-structures. To emphasise that this only a discussion of $\L$-structures for a specific language $\L$, we may sometimes write $\equiv_\L$.

\begin{remark*}[Exercise] (Sheet 1 Question 2) Let $T$ be an $\L$-theory. TFAE
\begin{enumerate}[label=\roman*)]
\item $T$ is complete
\item For an $\L$-sentence $\phi$, if $T\not\models \phi$ then $T\models \neg \phi$. We remark that for a model $\M$, $\M\not\models \phi\implies \M\models \neg \phi$, but this is \it{not} the case for \it{theories} in general.
\item Any two models of $T$ are elementarily equivalent.
\end{enumerate}
\end{remark*}
\begin{ex} Let $\L = \emptyset$ and $T = \{ \phi_n:n\ge 2 \}$ where $\phi_n$ is
	\[
	\exists x_1\dots\exists x_n \bigwedge_{i\ne j} x_i\ne x_j
	\]
	$T$ is then the \undf{theory of infinite sets}; its models are all of the infinite $\L$-structures. So, as $\L$-structures, $\N\equiv \Z\equiv \Q\equiv \R\equiv \C\equiv \mathcal{P}(\C) \equiv $ any infinite set.
\end{ex}

\begin{theorem}[Vaught's Test]
Let $T$ be an $\L$-theory such that
\begin{enumerate}[label=\alph*)]
\item $T$ has no finite models
\item $\exists \kappa \ge |\L| +\aleph_0$ such that any two models of $T$ of cardinality $\kappa$ are elementarily equivalent
\end{enumerate}
Then $T$ is complete.
\end{theorem}
\begin{proof}
Suppose $T$ is not complete. Then there is a sentence $\phi$ such that $T\cup\{\neg\phi\}$ is satisfiable, and $T\cup \{\phi\}$ is satisfiable.

By (a), these theories have infinite models. By Lowenheim-Skolem, these theories have models of size $\kappa$. But these are both models of $T$ and hence are elementarily equivalent $\bot$ by (b).
\end{proof}

\marginpar{Lecture 3}

Showing that two structures are elementarily equivalent is often difficult to do directly, so we need to find other ways around it.

\section{Homomorphisms}

Let $\L$ be a language.

\begin{defin}[$\L$-Homomorphism]
Let $\M$ and $\mathcal{N}$ be $\L$-structures. A function $h:M\ra N$ is an \undf{$\L$-homomorphism} if
\begin{enumerate}[label=\roman*)]
	\item for any $n$-ary function symbol $f$ and $a_1,\dots,a_n\in M$
	\[
	h(f^\M(a_1,\dots,a_N)) = f^\N(h(a_1),h(a_2),\dots,h(a_n))
	\]
	\item for any $n$-ary relation symbol $R$ and $a_1,\dots,a_n\in M$
	\[
	(a_1,\dots,a_n)\in R^\M \iff (h(a_1),\dots,h(a_n))\in R^\N
	\]
	\item for any constant symbol $c$, $h(c^\M) = c^\N$.
\end{enumerate}

We write $h:\M\ra\N$ for $\L$-homomorphisms $h$.

If $h$ is also injective, then $h$ is an \undf{$\L$-embedding}. If $h$ is also bijective, then $h$ is an \undf{$\L$-isomorphism}.
\end{defin}

\begin{theorem}[]
Suppose $h:\M\ra\n$ is an $\L$-isomorphism. Then for any $\L$-formula $\phi(x_1,\dots,x_n)$ and $a_1,\dots,a_n\in M$, we have
\[
\M\models\phi(a_1,\dots,a_n)\iff \n\models \phi(h(a_1),\dots,h(a_n))
\]
\end{theorem}
\begin{proof}
Often in situations like this, we will need to induct on the complexity of the formula, with the base case simply being the terms, and then atomic formulae, then all formulae.

\underline{Claim}: For any $\L$-term $t(x_1,\dots,x_n)$ and $a_1,\dots,a_n\in M$
\[
h(t^\M(a_1,\dots,a_n)) = t^\n(h(a_1),\dots,h(a_n))
\]
Proof of claim: induction on terms. If $t$ is a constant symbol $c$, then $h(t^\M) = h(c^\M) = h(c^\n) = t^\N$ since $h$ preserves functions (and thus constant symbols).

If $t$ is a variable $x_1$, then $h(t^\M(a_1)) = h(a_1) = t^\n(h(a_1))$ since variables are interpreted as the identity function.

Let $f$ be an $m$-ary function symbol. Assume the result for terms $t_1,\dots,t_m$ whose free variables are among $x_1,\dots,x_n$. Let $t$ be $f(t_1,\dots,t_m)$. Given $a_1,\dots,a_n\in M$:
\begin{align*}
h(t^\M(\overline{a}) &= h(f^\M(t_1^\M(\overline{a}),\dots,t_m^\M(\overline{a})))\\
&=f^\n(h(t_1^\M(\overline{a})),\dots,h(t_m^\M(\overline{a})))\\
&=f^\n(t_1^\n(h(\overline{a})),\dots,t_m^\n(h(\overline{a})))\\
&=t^\n(h(\overline{a}))
\end{align*}
So the claim is proven. Now we prove the theorem by induction on $\phi$.

\underline{Base case}: $\phi$ is atomic.
\begin{enumerate}[label=\arabic*)]
	\item $\phi$ is $t_1 = t_2$:
	\begin{align*} M\models \phi(\overline{a}) &\iff t_1^\M(\bar{a}) = t_2^\M(\bar{a})\\
		 &\iff h(t_1^\M(\bar{a})) = h(t_2^\M(\bar{a}))\textrm{ ($h$ injective)}\\
		 &\iff t_1^\n(h(\bar{a})) = t_2^\n(h(\bar{a}))\textrm{ (by claim)}\\
		 &\iff \N\models\phi(h(\bar{a}))
	\end{align*}
	\item $\phi$ is $R(t_1,\dots,t_n)$ (Exercise).
\end{enumerate}
\underline{Induction Step}: Assume the result for $\phi$ and $\psi$.

Exercise: check $\phi\land\psi$ and $\neg\phi$.

We will do $\forall x_n \phi(x_1,\dots,x_n)$, with free variables $x_1,\dots,x_{n-1}$. Fix $a_1,\dots,a_{n-1}\in M$.
\begin{align*}
M\models \forall x_n \phi(a_1,\dots,a_{n-1},x_n) &\iff \textrm{ for all }b\in M,\ \M\models \phi(a_1,\dots,a_{n-1},b)\\
&\iff \textrm{ for all }b\in M,\ \n\models \phi(h(a_1),\dots,h(a_{n-1}),h(b))\textrm{ (induction)}\\
&\iff \textrm{ for all }c\in N,\ \n\models \phi(h(a_ 1),\dots,h(a_{n-1}),c)\textrm{ ($h$ surjective)}\\
&\iff \N\models\forall x_n \phi(h(a_1),\dots,h(a_{n-1}),x_n)
\end{align*}
And so we are done. In particular, $\L$-isomorphisms preserve all formulae.
\end{proof}

\begin{remark*}[Notation]
We write $\M \cong \n$ if there is an $\L$-isomorphism $h:\M\ra\n$.
\end{remark*}

\begin{cor}
If $\M\cong \N$ then $\M \equiv \N$.
\end{cor}

Note that, as we can see, $\cong$ is stronger than $\equiv$; $\cong$ says that two structures are more or less the same, whereas $\equiv$ only makes an assertion about first order statements satisfied by the models.

\begin{cor}
$h:\M\ra\N$ is an $\L$-embedding iff for any quantifier-free the conclusion of Theorem 2.2 holds for all quantifier-free formulas $\phi(x_1,\dots,x_n)$. That is to say, $\L$-embeddings preserve all quantifier-free formulas.
\end{cor}
\begin{proof}
$(\implies)$ is done by the proof of 2.2; we only used the surjectivity of $h$ for the quantifier step.
For $(\impliedby)$, see Sheet 1, Question 6.
\end{proof}

An embedding is precisely characterised by preserving quantifier-free formulae. This motivates the question, what about maps that preserve all formulas? We know that isomorphisms will do, but is that all of them? The answer is in fact no, in general.

\begin{defin}[Elementary $L$-Embedding]
$h:\M\ra\N$ is an \undf{elementary $\L$-embedding} if for any $L$-formula $\phi(\bar{x})$ and $\bar{a}$ from $M$, $\M\models \phi(\bar{a})$ iff $\N\models \phi(h(\bar{a}))$.
\end{defin}

Note that isomorphisms are elementary embeddings, but elementary embeddings need not be isomorphisms.

\begin{defin}[Elementary Substructure]
Let $\M$ and $\N$ be $\L$-structures with $M\subset N$. Let $h:M \xhookrightarrow{} N$ be the inclusion map. Then $\M$ is a \undf{substructure} of $\N$ (respectively, \undf{elementary substructure}), written $\M\subset \N$ (respectively $\M\preceq\N$) if $h$ is an $\L$-embedding (respectively, elementary embedding).

Similarly, $\N$ is an \undf{extension} of $\M$ (respectively, \undf{elementary extension}).
\end{defin}	

\begin{remark*}[Note]
If $\M\preceq\N$ then $M\subset N$ and $\M\equiv \N$.
\end{remark*}
\begin{ex}
Let $\M = (2\Z, <)$ and $\N = (\Z, <)$.

Then $\M \subset \N$ and $\M \equiv \N$, but $\M\not\preceq\N$, for instance $\M\models \neg\exists x(0 < x < 2)$, but this is of course untrue for $\N$.

So the inclusion map might be an embedding, but it is not necessarily elementary.
\end{ex}

\marginpar{Lecture 4}

\section{Categoricity}

\underline{Q}: Suppose $\M\equiv\N$. Then is it true that $\M \cong \N$?

\underline{A}: No - \it{e.g.} theory of infinite sets, any two infinite sets are elementarily equivalent but many are obviously not isomorphic. More generally, if $\M$ is infinite then Th$(\M)$ has models of arbitrarily large size.

So a theory with infinite models \it{never} has a unique model up to isomorphism, as models of different cardinalities cannot be isomorphic (since an isomorphism contains a bijection).

\begin{defin}[$\kappa$-categorical]
An $\L$-theory $T$ is \undf{$\kappa$-categorical} if it has a unique model of size $\kappa$ up to isomorphism.
\end{defin}
Our main focus for theories here will be those $T$ that have infinite models and $\kappa \ge |\L| + \aleph_0$.

\begin{ex}\ 
\begin{enumerate}[label=\arabic*)]
	\item Th$(\mathbb{N})$ in $\L = \emptyset$ is $\kappa$-categorical for all $\kappa \ge \aleph_0$ (Sheet 1 \#3)
	\item Th$(\Q,+)$ is $\kappa$-categorical iff $\kappa > \aleph_0$ (related to Sheet 1 \#4)
	\item Th$(\Q,<)$ is $\kappa$-categorical iff $\kappa = \aleph_0$
	\item Th$(\Z,+)$ is $\kappa$-categorical for no $\kappa$
\end{enumerate}
\end{ex}
***Non-Examinable***
\begin{theorem*}[Morley's Theorem (1965)]
Let $T$ be a complete theory in a countable language. If $T$ is $\kappa$-categorical for some $\kappa > \aleph_0$, then it is $\kappa$-categorical for all $\kappa > \aleph_0$.
\end{theorem*}
***End of non-examinable section***

\begin{defin}[Theory of Dense Linear Orders]
Let $\L = \{<\}$ (binary relation) be the language of partial orders. Define \undf{DLO (dense linear orders)} to be the following theory
\begin{itemize}
	\item $\forall x\neg (x < x)$
	\item $\forall x \forall y \forall z ((x < y \land y < z) \ra x < z)$ (partial order)
	\item $\forall x\forall y ((x\ne y) \ra (x < y \lor y < x))$ (linear order)
	\item $\forall x \forall y(x < y \ra \exists z (x < z < y))$ (dense)
	\item $\forall x \exists y \exists z (y < x < z)$ (no endpoints)
\end{itemize}
Note that $(\Q,<)\models$ DLO.
\end{defin}

\begin{theorem}[Cantor, 1895]
DLO is $\aleph_0$-categorical.
\end{theorem}
\begin{proof}
``Back and Forth Construction''.

Fix countable models $\M,\N\models$ DLO. Let $M = \{a_n:n\ge 0\}$ and $N = \{b_n:n\ge 0\}$. With these enumerations we will construct an isomorphism between $\M$ and $\N$.

We will inductively construct a sequence $(h_n)_{n=0}^{\infty}$ of functions such that:
\begin{enumerate}[label=\arabic*)]
	\item $h_n:X_n\ra Y_n$ is an order-preserving bijection, where $X_n\subset M$ and $Y_n\subset N$ are finite
	\item $X_n\subset X_{n+1}$, $Y_n\subset Y_{n+1}$ and $h_n\subset h_{n+1}$
	\item $a_n \in X_n$ and $b_n \in Y_n$
\end{enumerate}
Once we have done this, we will have a sequence of increasing functions with domains and ranges getting bigger and bigger. We can then let $h = \bigcup_{n=0}^{\infty}h_n$. Then $h$ is an order-preserving bijectionfrom $M$ to $N$, which in this language is precisely an $\L$-isomorphism.

\underline{Base case}: Let $X_0 = \{a_0\}$, $Y_0 = \{b_0\}$, and $h_0 = \{(a_0,b_0)\}$; this trivially satisfies all the desired properties.

Now assume we have $h_n:X_n\ra Y_n$ as above.

\underline{Forth}: Construct an order-preserving bijection $h_\ast:X_\ast\ra Y_\ast$ extending $h_n$ with $a_{n+1}\in X_\ast$. Enumerate $X_n = \{x_1,\dots,x_k\}$ such that $x_1 <^\M \dots <^\M x_k$. Let $y_i = h_n(x_i)$. Then $y_1 <^\N \dots <^\N y_k$ since $h_n$ is order-preserving.

Define $h_\ast = h_n \cup \{(a_{n+1},b)\}$ where $b\in N$ is chosen as follows.

\underline{Case 1}: $a_{n+1} = x_i$ for some $i\le k$. Let $b = y_i$.

\underline{Case 2}: $x_k <^\M a_{n+1}$. Choose $b\in N$ such that $y_k <^\N b$.

\underline{Case 3}: $a_{n+1} <^\M x_1$. Choose $b\in N$ such that $b <^\N y_1$.

\underline{Case 4}: $x_i <^\M a_{n+1} <^\M x_{i+1}$ for some $ i < k$. Choose $b \in N$ such that $y_i < ^\N b < ^\N y_{i+1}$.

\underline{Back}: Construct order-preserving $h_{n+1}:X_{n+1}\ra Y_{n+1}$ extending $h_\ast$ such that $b_{n+1}\in Y_{n+1}$; details are an exercise (though it is basically the same as the above).
\end{proof}
\begin{cor}
DLO is a complete theory.
\end{cor}
\begin{proof}
Apply Vaught's Test. Note that DLO clearly has no finite models.

If $\M,\N\models$ DLO are countable then $\M \cong \N$, so $\M \equiv \N$.
\end{proof}

So $(\Q,<) \equiv (\R,<)\equiv $ any dense linear order without endpoints. In particular, any two such orders cannot be distinguished by a first order statement in the language of partial orders.

\begin{remark*}[More Notions]
Let $\L$ be a language. Suppose $\M$ is an $\L$-structure. Fix a collection $(\M_i)_{i\in I}$ of substructures of $\M$. Let $\N = \bigcap_{i\in I}M_i$; assume $N \ne \emptyset$ (this will always happen as along as there are some constant symbols, say). Then we have a canonical $L$-structure $\N$ with universe $N$, by interpreting the language in the only way that makes sense. That is, $f^\N = f^\M |_\N = f^{\M_i} |_\N$, $R^\N = R^\M \cap N^{\alpha(R)} = R^{\M_i}\cap N^{\alpha(R)}$, $c^\N = c^\M = c^{\M_i}$.

Note $\N \subset \M_i$ for all $i\in I$.
\end{remark*}
\begin{defin}[Generated Substructure]
Given a structure $\M$ and a non-empty set $A\subset M$, the \undf{substructure of $\M$ generated by $A$} is the intersection of all substructures of $\M$ containing $A$.
\end{defin}

\begin{defin}[Chain of $\L$-structures]
Let $\alpha$ be a limit ordinal. A collection $(\M_i)_{i<\alpha}$ of $\L$-structures is a \undf{chain} if $\M_i \subset \M_{j}$ for all $i < j$.

If in fact the condition above is strengthened to $\preceq$, then we say it is an \undf{elementary chain}.

If $(M_i)_{i<\alpha}$ is a chain then we have a well-defined structure $\bigcup_{i < \alpha}\M_i$.
\end{defin}

\marginpar{Lecture 5}

\section{Algebraically Closed Fields}

\begin{remark*}[Recall]
$(K,+,\cdot,0,1)$ is a \undf{field} if $(K,+,0)$ and $(K\backslash\{0\},\cdot,1)$ are abelian groups and $\forall x\forall y\forall z((x\cdot(y+z) = x\cdot y + x\cdot z))$.

$K$ is \undf{algebraically closed} if every non-constant polynomial over $K$ has a root in $K$.
\end{remark*}
Let $\L = \{+,\cdot,0,1\}$, the language of fields.

\begin{defin}[ACF]
The first order $\L$-theory axiomatising algebraically closed fields is known as \undf{ACF} - all the above statements can be given as first order $\L$-sentences.

In particular, this contains the field axioms and for every $d\ge 1$ the claim that every degree $d$ polynomial has a root:
\begin{align*}
\forall v_0\forall v_1\dots\forall v_{d-1}\exists x(x^d + v_{d-1}x^{d-1}+\dots+v_1x+v_0 = 0)
\end{align*}
We take this statement for every $d$, {\it i.e.} we have infinitely many.
\end{defin}
\begin{remark*}
ACF is not complete, since it does not specify characteristic - hence different models are distinguishable by a first order property.
\end{remark*}
\begin{defin}[$\textrm{ACF}_0,\ \textrm{ACF}_p$]
For $n\ge 1$, let $\chi_n$ be the $\L$-sentence
\begin{align*}
	\underbrace{1+1+\dots+1}_{n} = 0
\end{align*}
We then have the theory of algebraically closed fields of characteristic zero, \undf{ACF$_0$}:
\begin{align*}
\acf_0 = \acf\cup\{\neg\chi_n:n\ge1\}
\end{align*}
For a prime $p$, we have $\acf_p = \acf\cup\{\chi_p\}$
\end{defin}

\begin{theorem}
$\acf_0$, $\acf_p$ are $\kappa$-categorical for all $\kappa > \aleph_0$.
\end{theorem}
\begin{proof}
The \undf{transcendence degree} of $K\models\acf$ is the cardinality of the largest algebraically independent susbet of $K$.

For example, trdeg$(\bar{Q}) = 0$, trdeg$(\overline{\Q(\pi)}) = 1$, trdeg$(\C) = 2^{\aleph_0}$, trdeg$(\overline{\Q(x_i)}_{i<\kappa})=\kappa$

\begin{remark*}[Facts]\ 
\begin{enumerate}[label=(\arabic*)]
	\item Suppose $K,L\models\acf$. Then $K\cong L$ iff trdeg$(K)$ = trdeg$(L)$, char$(K)$ = char$(L)$, and $|K| = |L|$
	\item If $K\models \acf$ and $\kappa = $trdeg$(K)$, then $|K| = \aleph_0 + \kappa$
\end{enumerate}
\end{remark*}
\underline{Conclusion}: If $K,L\models \acf_0$ (or $\acf_p$) are uncountable and $|K| = |L|$, then $K\cong L$.
\end{proof}
\begin{cor}
$\acf_0$ and $\acf_p$ are complete.
\end{cor}
\begin{proof}
Vaught's Test.
\end{proof}
\begin{remark*}
$\acf_0$, $\acf_p$ are not $\aleph_0$-categorical.

The countable models are precisely the countable $\acf_p$s of trdeg $n$ for $n\in \N\cup\{\aleph_0\}$.
\end{remark*}

\begin{defin}[Polynomial Map]
Let $K$ be a field. A function $\Phi: K^m\ra K^n$ is a \undf{polynomial map} if
\begin{align*}
\Phi = \big(p_1(x_1,\dots,x_m),p_2(x_1,\dots,x_m),\dots,p_n(x_1,\dots,x_m)\big)
\end{align*}
where $p_i \in K[\bar{x}]$ for each $i$.
\end{defin}
\begin{theorem}[Ax-Grothendieck]
Let $K\models \acf$ and suppose $\Phi:K^n\ra K^n$ is an injective polynomial map. Then $\Phi$ is surjective.
\end{theorem}
\begin{proof}
First, suppose that $K = \bar{\mathbb{F}}_p$ for some prime $p$. Recall that $\bar{\mathbb{F}}_p = \bigcup_k \mathbb{F}_{p^k}$. Fix $m$ such that all coefficients in $\Phi$ come from $\mathbb{F}_{p^m}$. Note that $\bar{\mathbb{F}}_p = \bigcup_k \mathbb{F}_{p^{km}}$.

Then for any $k\ge 1$, $\Phi$ induces an injective polynomial map from $\mathbb{F}_{p^{km}}^n \ra \mathbb{F}_{p^{km}}^n$m , which therefore is surjective since the sets we are dealing with are finite.
\begin{align*}
\Phi\left(\bar{\mathbb{F}}_p^n\right) &= \Phi\left(\bigcup_k\mathbb{F}_{p^{km}}^n\right)\\
&= \bigcup_k\Phi\left(\mathbb{F}_{p^{km}}^n\right) = \bigcup_k\mathbb{F}_{p^{km}}^n\\
&=\bar{\mathbb{F}}_p^n
\end{align*}
Now, given $n,d\ge 1$, let $\psi_{n,d}$ be the $\L$-sentence which says:

``Every injective polynomial map with $n$ coordinates, each of which is a polynomial in $n$ variables and degree $\le d$, is surjective.''

Exercise: show that this is first order.
\end{proof}

We've shown $\bar{\F}_p \models \psi_{n,d}$ for all primes $p$ and $n,d$.

So for any prime $p$, $\acf_p\models\psi_{n,d}$ for all $n,d$ since $\acf_p$ is complete.

Now consider $\acf_0$. For contradiction, suppose that there exists soem $n,d$ such that $\acf_0\not\models\psi_{n,d}$. Then $\acf_0\models\neg\psi_{n,d}$ since $\acf_0$ is complete. By Compactness, there is a finite set $\Sigma\subset \acf_0$ such that $\sigma \models \neg \psi_{n,d}$. So $\Sigma\subset \acf\cup\{\neg\chi_1,\dots,\neg\chi_m\}$ for some $m$. Choose a prime $p > m$. Then $\acf_p\models \Sigma$.

So $\acf_p\models \neg\psi_{n,d}$, which is a contradiction.
\begin{theorem}[Lefschetz Principle]
Let $\phi$ be an $\L$-sentence. TFAE
\begin{enumerate}[label=(\arabic*)]
	\item $\acf_0\models \phi$ {\it i.e.} $\phi$ is true in every $K\models \acf$
	\item $\acf_0\cup\{\phi\}$ is consistent, {\it i.e.} $\phi$ is true in some $K\models \acf_0$
	\item There is some $n > 0$ such that $\acf_p\models\phi$ for all $p > n$ {\it i.e.} $\phi$ is true in every $K\models \acf$ of sufficiently large characteristic
	\item For all $n > 0$ there exists $p > n$ such that $\acf_p\cup\{\phi\}$ is consistent, {\it i.e.} $\phi$ is true in some $K\models \acf$ of arbitrarily large characteristic.
\end{enumerate}
\end{theorem}

\marginpar{Lecture 6}

\section{Diagrams \& Extensions}

Let $\M$ be an $\L$-structure.

\begin{theorem}[Remark!]
%CHANGE THIS TO A NUMBERED REMARK!
If $h:\M\ra\N$ is an $\L$-embedding then after identifying $a\in M$ with $h(a) \in N$, we can view $\M$ as a substructure of $\N$.

Similarly, if $h$ is an elementary embedding then $\M$ can be viewed as an elementary substructure of $\N$.
\end{theorem}

Given $A\subset M$, let $\L_A = \L\cup\{\underline{a}:a\in A\}$, where $\underline{a}$ is a new constant symbol. We underline it to differentiate it from the element in $A$.

Then $\M$ is canonically an $\L_A$-structure, with $\underline{a}^\M = a$.

\begin{defin}[Diagram]
The \undf{diagram of $\M$}, written $\\D(\M)$, is the $\L_M$-theory consisting of all quantifier-free $\L_M$-sentences $\phi$ such that $\M\models \phi$.

Similarly, the \undf{elementary diagram of $\M$}, written $\Th_M(\M)\coloneqq \Th_{\L_M}(M)$.
\end{defin}

\begin{prop}
Suppose $\M$ is an $\L$-structure and $\N^\ast$ is an $\L_M$-structure such that $\N^\ast\models \\D(\M)$. Let $\N$ be the reduct of $\N^\ast$ to $\L$. Define $h:\M\ra\N$ such that $h(a) = \underline{a}^{\N^\ast}$. Then $h$ is an $\L$-embedding.

Moreover, if $\N^\ast\models \Th_M(\M)$, then $h$ is an elementary embedding.
\end{prop}
\begin{proof}
Use Corollary 3.4. Let $\phi(x_1,\dots,x_n)$ be a quantifier-free $\L$-formula, and fix $a_1,\dots,a_n\in M$. Then $\M\models \phi(a_1,\dots,a_n)$ iff $\M\models \phi(\underline{a_1},\dots,\underline{a_n})$ iff $\phi(\underline{a_1},\dots,\underline{a_n})\in \\D(\M)$ iff $\N^\ast\models\phi(\underline{a_1},\dots,\underline{a_n})$ iff $\N\models \phi(h(a_1),\dots,h(a_n))$.

The ``moreover'' statement is similar (just drop the quantifier-free claim).
\end{proof}

\subsection*{Application to Groups}

Recall that an abelian group $G$ is \undf{orderable} if there is a linear order $<$ on $G$ such that for all $x,y,z\in G$ , if $x<y$ then $x+z < y+z$.

Note that any orderable abelian group is torsion-free, since $x > 0\implies nx > 0$ for every $n$. Similarly for $x < 0$. We now prove the converse:

\begin{theorem}[Levi 1942]
Any torsion-free abelian group is orderable.
\end{theorem}
\begin{proof}
Let $\L^0 = \{+,0\}$ be the language of (abelian) groups. Set $\L = \L^0 \cup\{<\}$, where $<$ is a binary relation symbol. Let $\sigma$ be the $\L$-sentence
\begin{align*}
\forall x \forall y\forall z ( x< y \ra x + z < y + z)
\end{align*}
Now let $G$ be a torsion-free abelian group, viewed as an $\L^0$ structure.

Define the $\L_G$-theory
\begin{align*}
T = \underbrace{\D(G)}_{\L_G^0\textrm{-theory}}\cup\{\textrm{axioms for linear order \& abelian groups}\}\cup\{\sigma\}
\end{align*}

Suppose $T$ has a model $\M$. Then $(M,+^\M,0^\M,<^\M)$ is an ordered abelian group, and $G\subset (M,+^\M,0^\M)$ by Prop 6.3. So $G$ is a subgroup of an ordered abelian group, which is thus orderable.

So all that remains is to show that $T$ has a model.

Fix $\Sigma \subset T$ finite. Let $A = \{a\in G: \underline{a}\textrm{ appears in some }\L_G^0\textrm{-sentence in }\Sigma\}$, and let $H = \langle A\rangle \le G$. Then $H\cong \Z^n$ for some $n\ge 0$ by the structure theorem for (torsion-free) finitely generated abelian groups. View $H$ as an $\L_A$-structure such that $\underline{a}^H = a$ and $<^H$ is the lexicographic ordering. Then $H\subset_{\L_A^0} G$, and so $H\models \phi$ for any $\phi \in \D(G)$, using only extra constants from $A$ by Corollary 3.4.

So $H\models \Sigma$. So done by Compactness.
\end{proof}


\section{Quantifier Elimination}

\underline{Idea}: Let $T$ be an $\L$-theory and let $\M\models T$. Then $X\subset M^n$ is \undf{definable} if there is an $\L$-formula $\phi(x_1,\dots,x_n)$ such that $X = \{\bar{a}\in M^n : \M\models \phi(\bar{a})\}$.

\underline{Goal}: Study definable subsets of models of $T$.

Unfortunately, quantifiers make this difficult. $X$ itself might be nice, by the projection $Y = \{(a_1,\dots,a_{n-1})\in M^{n-1}:(\bar{a},\bar{b})\in X\textrm{ for some }b\in M\}$ (defined by $\exists x_n \phi(\bar{x})$) might be complicated.

\begin{defin}[Quantifier Elimination]
An $\L$-theory $T$ has \undf{quantifier elimination} if for any $\L$-formula $\phi(x_1,\dots,x_n)$ there is a quantifier-free $\L$-formula $\psi(x_1,\dots,x_n)$ such that
\begin{align*}
T\models \forall \bar{x}\big((\phi(\bar{x})\leftrightarrow \psi(\bar{x}))
\end{align*}
That is to say, $\phi$ and $\psi$ define the same set in any $\M\models T$.
\end{defin}

\begin{ex}\ 
\begin{enumerate}[label=(\arabic*)]
\item $T = \Th(F)$, where $F$ is a field. Let $\phi(w,x,y,z)$ be the statement ``$\left(\begin{array}{cc} w & x\\ y & z\end{array}\right)\textrm{ has an inverse}$'', {\it i.e.} there exist $s,t,u,v$ forming a matrix that inverts it.

Then $T\models \forall w\forall x\forall y\forall z\big(\phi(w,x,y,z)\leftrightarrow wz-xy\ne 0\big)$.

\marginpar{Lecture 7}

\item $T = \Th(\R,+,\cdot,0,1)$. $\phi(x)$ is $\exists y(x = y^2)$. Note that $\phi$ defines $\R^{\ge 0}$. We can in fact not write this quantifier-free:

Suppose $\psi(x)$ is quantifier-free. In this case the terms are just polynomials, so $\psi(x)$ is a Boolean combination of polynomial equations. So $\psi$ defines a finite or cofinite subset of $\R$, and in particular cannot define the positive reals. Hence $T$ does not have QE.

We will later see that $\Th(\R,+,\cdot,<,0,1)$ {\it does} have QE. Note that $x < y \iff \exists z: (z\ne 0 \land y-x = z^2)$. In particular, adding the ordering relation doesn't really add anything new to what we can define in this language.

So $(\R,+,\cdot,0,1)$ and $(\R,+,\cdot,<,0,1)$ have the same definable sets, which means they are very similar structures. So the important thing to note is that QE is very language-dependent, and while we might not immediately have QE we might be able to just go out and look for it.
\end{enumerate}
\end{ex}

We will now discuss some quantifier elimination tests.

\begin{lemma}
Suppose $T$ is an $\L$-theory such that for any q.f. formula $\phi(x_1,\dots,x_m,y)$ there is a q.f. $\psi(x_1,\dots,x_n)$ such that $T\models \forall \bar{x}\big(\exists y \phi(\bar{x},y)\leftrightarrow \psi(\bar{x})\big)$. Then $T$ has QE.
\end{lemma}
\begin{proof}
Induction on formulas (exercise).
\end{proof}

So we only need to eliminate one quantifier at a time.

\begin{theorem}
Let $T$ be an $\L$-theory. TFAE:
\begin{enumerate}[label=\roman*)]
	\item $T$ has QE
	\item Suppose $\M,\N\models T$ and $\A\subset\M,\A\subset\N$. Then for any q.f. formula $\phi(\bar{x},y)$ and any tuple $\bar{a}$ of parameters from $A$, if $\M\models \exists y\phi(\bar{a},y)$ then $\N\models \exists y \phi(\bar{a},y)$.
	\item For any $\L$-structure $\A$, $T\cup \mathcal{D}(\A)$ is a complete $\L_A$-theory.
\end{enumerate}
\end{theorem}
\begin{proof}
(i)$\implies$(iii). Assume $T$ has QE. Let $\A$ be an $\L$-structure and suppose $\M,\N\models T\cup \D(\A)$. We want to show that $\M \equiv_{\L_A} \N$.

Let $\sigma$ be an $\L_A$-sentence such that $\M\models \sigma$. WTS $\N\models \sigma$. Write $\sigma$ as $\phi(\underline{a}_1,\dots,\underline{a}_n)$ for some $\L$-formula $\phi(x_1,\dots,x_n)$ and $a_1,\dots,a_n\in A$. By QE, there is a q.f. $\psi(x_1,\dots,x_n)$ such that $T\models \forall \bar{x}\big(\phi(\bar{x})\leftrightarrow \psi(\bar{x})\big)$.

Since $\M\models T$ and $\M\models \phi(\bar{a})$, we have $\M\models \psi(\bar{a})$. Since $\M\models\D(\A)$, we have $\psi(\underline{a}_1,\dots,\underline{a}_n)\in\D(\A)$. But $\N$ models the diagram, so $\N\models\psi(\underline{a}_1^\N,\dots,\underline{a}_n^\N)$. Since $\N\models T$, $\N\models \phi(\underline{a}_1,\dots,\underline{a}_n)$, {\it i.e.} $\N\models \sigma$.

(iii)$\implies$(ii) Let $\M,\N,\A,\phi(\bar{x},y),\bar{a}$ be as in the hypothesis of (ii). Since $\A\subset \M$ and $\A\subset \N$, we have that $\M,\N\models T\cup \D(\A)$ by Cor 2.4. By (iii), this is a complete theory and so $\M\equiv_{\L_A}\N$. So $\M\models \exists y\phi(\bar{a},y)$, which is an $\L_A$-sentence, implies $\N\models \exists y \phi(\bar{a},y)$.

(ii)$\implies$(i) By Lemma 6.1, it suffices to fix q.f. $\phi(\bar{x},y)$ and find q.f. $\psi(\bar{x})$ such that $T\models \forall \bar{x}\big(\exists y \phi(\bar{x},y)\leftrightarrow\psi(\bar{x})\big)$.

Let $\L^\ast = \L \cup \{c_1,\dots,c_n\}$ where $c_i$ is a new constant symbol. Let $\Gamma = \{\psi(\bar{c}): \psi(\bar{x})$ is a q.f. $\L$-formula and $T\models \forall\bar{x} \big(\exists y\phi(\bar{x},y)\rightarrow \psi(\bar{x})\big)\}$.

\underline{Claim}: $T\cup \Gamma \models \exists y\phi(\bar{c},y)$.

First, assume the claim holds. By Compactness, there exists a q.f. $\psi_1(\bar{x}),\dots,\psi_m(\bar{x})$ such that $T\cup\{\psi_1(\bar{c}),\dots,\psi_m(\bar{c})\}\models \exists y\phi(\bar{c},y)$ and $T\models \forall \bar{x}\big(\exists y\phi(\bar{x},y)\rightarrow \bigwedge_{i=1}^{m}\psi_i(\bar{x})\big)$. Let $\psi(\bar{x})$ be $\bigwedge_{i=1}^{m}\psi_i(\bar{x})$. Then $T\models \big(\psi(\bar{c}) \rightarrow \exists y\phi(\bar{c},y)\big)$.

So $T\models \forall \bar{x}\big(\psi(\bar{x}) \rightarrow \exists y \phi(\bar{x},y)\big)$ (exercise ``generalisation''). So $T\models \forall \bar{x}\big(\psi(\bar{x})\leftrightarrow \exists y\phi(\bar{x},y)\big)$.

\underline{Proof of Claim}: Suppose not. There is $\N\models T\cup\Gamma \cup \{\neg \exists y\phi(\bar{c},y)\}$. Let $a_i = c_i^\N$ and let $\A\subset\N$ be the substructure generated by $a_1,\dots,a_n$. Then $\N\models T$, $\A\subset\N$, and $\N\models \neg \exists y\phi(\bar{a},y)$.

By ES1 \#7, any $b \in A$ is of the form $t^\N(\bar{a})$ for some $\L$-term $b$. So we can view $\D(\A)$ as an $\L^\ast$-theory by replacing $\underline{b}$ with $t(c_1,\dots,c_n)$. Let $\Sigma\models T\cup\D(\A)\cup\{\exists y\phi(\bar{c},y)\}$. If we build $\M\models \Sigma$ then $\M\models T$, $\A\subset \M$ and $\M\models \exists y \phi(\bar{a},y)$, contradicting (ii).

So it suffices to show $\Sigma$ has a model, which we will do by compactness. Suppose this fails. Then by compactness there are q.f. $\psi_1(\bar{x}),\dots,\psi_m(\bar{x})$ such that $\psi_1(\bar{c}),\dots,\psi_m(\bar{c})\in\D(\A)$ and $$ T\cup \left\lbrace \bigwedge_{i=1}^{m}\psi_i(\bar{c})\right\rbrace \cup \left\lbrace \exists y \phi(\bar{c},y)\right\rbrace$$ is unsatisfiable. Let $\psi(\bar{x})$ be $\neg \bigwedge_{i=1}^{m}\psi_i(\bar{x})$. Then $T\models \big(\exists y\phi(\bar{c},y)\rightarrow \psi(\bar{c})\big)$. So $T\models \forall \bar{x} \big(\exists y \phi(\bar{x},y)\rightarrow\psi(\bar{x})\big)$. So $\psi(\bar{c})\in \Gamma$. So $\N\models \psi(\bar{c})$. since $\N\models \D(\A)$, we have $\N\models \neg \psi(\bar{c})$. Contradiction.
\end{proof}


\marginpar{Lecture 8}

\begin{remark*}
Recall Theorem 6.2 (QE test)
\begin{enumerate}[label=\arabic*)]
	\item In condition (iii), we may assume that $\A\subset\M$ for some model $\M\models T$. Otherwise, $T\cup \D(\A)$ is inconsistent and thus complete
	\item In both conditions (ii) and (iii), we may assume that $\A$ is finitely generated
\end{enumerate}
\end{remark*}

\begin{theorem}
$\acf$ has quantifier elimination.
\end{theorem}
\begin{proof}
We apply Theorem 6.2(iii). Fix a finitely-generated $\L$-structure $\A$ (in the language of fields). We want to show $\acf\cup \D(\A)$ is complete. We use Vaught's Test.

Fix $K_1,K_2\models\acf\cup \D(\A)$ uncountable with $|K_1| = |K_2|$. Then $\A$ is a finitely generated integral domain contained in $K_1$ and $K_2$.

So char$(K_1)$ = char\((K_2)\). Let $F_i$ be the field of fractions of $\A$ in $K_i$. There is a field isomorphism $\tau : F_1\ra F_2$ fixing $\A$ pointwise. Since $\A$ is finitely generated, trdeg$(F_i)$ is finite. So trdeg$(K_1/F_1)$ = trdeg$(K_2/F_2)$.

So $\tau$ extends to an isomorphism $\tau^\ast: K_1\ra K_2$ fixing $\A$.
\end{proof}
We now see a very common application of quantifier elimination of $\acf$.

\begin{defin}[Constructible Set]
Let $F$ be a field. Then $X\subset F^n$ is \undf{constructible} if it is a Boolean combination of subsets of $F^n$ defined by $p(x_1,\dots,x_n) = 0$, where $p \in F[x_1,\dots,x_n]$.
\end{defin}
\begin{cor}[Chevalley]
If $K\models \acf$ and $X\subset K^n$ is constructible, then the projection
\begin{align*}
Y = \{(a_1,\dots,a_{n-1})\in K^{n-1}:(\overline{a},b)\in X\textrm{ for some }b\in K\}
\end{align*}
is constructible.
\end{cor}

\begin{remark*}[Compare]
Consider $X = \{(x,y)\in \R^2:x = y^2\}$. Then $Y = \R^{\ge 0}$.

Exercise: think about more examples in the rationals.
\end{remark*}
\begin{proof}
Note that $X\subset K^n$ is constructible iff there is a quantifier-free formula $\phi(x_1,\dots,x_n,y_1,\dots,y_m)$ ($y_i$ parameters) and parameters $b_1,\dots,b_m\in K$ such that $X$ is defined by $\phi(\bar{x},\bar{b})$.

Fix quantifier-free formula $\phi(\bar{x},\bar{y})$ and $\bar{b}$ such that $\phi(\bar{x},\bar{b})$ defines $X$. Let $\psi(x_1,\dots,x_{n-1},\bar{y})$ be $\exists x_n\phi(\bar{x},\bar{y})$. Then $\psi(\bar{x},\bar{b})$ defines $Y$. Then by $QE$ $\psi(\bar{x},\bar{y})$ is equivalent to some quantifier-free formula. So $Y$ is constructible.
\end{proof}

\subsection*{Rado Graphs}

We work with the language of graphs $\L = \{E\}$, $E$ a binary relation.

\begin{defin}[Rado Graph]
A \undf{Rado Graph} is a graph $(V,E)$ such that $V\ne \emptyset$ and for any finite disjoint $X,Y\subset V$ there is some $v\in V$ such that $E(v,x)$ for all $x\in X$ and $\neg E(v,y)$ for all $y\in Y$.
\end{defin}
\begin{defin}[RG]
We let $\rg$ be the theory of Rado graphs in the language of graphs. In particular:
\begin{align*}
	\rg &= \{ \forall x \neg E(x,x),\forall x\forall y(E(x,y)\ra E(y,x)) \}\\
		&\cup \left\lbrace \forall x_1,\dots,x_k\forall y_1,\dots,y_k\left(\bigwedge_{i,j}x_i\ne x_j \ra \exists v\left(\bigwedge_{i=1}^{k}E(x_i,v) \land \bigwedge_{i=1}^{k}\neg E(y_i,v)\right)\right):k\ge 1\right\rbrace
\end{align*}
\end{defin}

\begin{theorem}
$\rg$ is $\aleph_0$-categorical.
\end{theorem}
\begin{proof}\ 
\begin{enumerate}[label=\arabic*)]
	\item $\rg$ has a countable model.
	
	Let $A = (V,E)$ be any finite graph. Set $A_0 = A$. Given $A_n$, define $V(A_{n+1}) = V(A_n)\cup\{v_{X,Y}:X,Y\subset V(A_n)\textrm{ disjoint}\}$, with new edges $E(v_{X,Y},x)$ for all $x\in X$ (and no others). So $A_0\subset A_1\subset A_2\subset\dots$ is a chain of substructures.
	
	Let $M = \bigcup_{n=0}^{\infty}A_n$. Then $M\models\rg$. Moreover, $M$ is countable since each $A_n$ is finite. 
	
	\item Any two countable models are elementarily equivalent.
	
	Let $\M,\N\models \rg$ countable. We show $\M\cong \N$ via a back and forth argument. Enumerate $M = \{a_n : n\ge 0\}$ and $N = \{b_n:n\ge 0\}$. Let $h_0: a_0\mapsto b_0$. Given $h_n:X_n\ra Y_n$, extend to include $a_{n+1}$ and $b_{n+1}$.
	
	Partition $X_n$ into the neighbourhood of $a_{n+1}$ and its complement. We then partition $Y_n$ by its image under $h_n$, and use the Rado axioms to find a vertex $b$ connected to $h_n(\Gamma(a_{n+1}))$ and none of its complement. Similarly find appropriate $a$ for $b_{n+1}$, and extend $h_n$ to include these pairs, giving us $h_{n+1}$.
\end{enumerate}
Hence $\rg$ is $\aleph_0$-categorical.
\end{proof}
\begin{cor}
$\rg$ is complete
\end{cor}
\begin{proof}
Use Vaught's Test. Note that $\rg$ has no finite models.
\end{proof}
\begin{remark*}[Claim]
If $\M\models \rg$ then every finite graph is an induced subgraph of $\M$.
\end{remark*}
\begin{proof}
The proof of Theorem 7.6 shows this when $\M$ is countable. Then for any $\M\models \rg$ there exists a countable $\M_0$ such that $\M_0\le \M$ by DLST ({\it c.f.} Sheet 1 Question 9).
\end{proof}
\begin{remark*}[Exercise]
	Suppose $\M,\N\models\rg$ countable and $f: X\ra Y$ is a graph isomorphism for some finite $X\subset \M$ and $Y\subset \N$. Then $f$ extends to an isomorphism from $\M$ to $\N$.
\end{remark*}
\marginpar{Lecture 9}

\begin{theorem}
RG has QE
\end{theorem}
\begin{proof}
\underline{Option 1}: Theorem 6.2(iii). Consider $RG \cup \D(\A)$, where $\A$ is a finite graph (see last exercise).

\underline{Option 2}: Theorem 6.2(ii). Fix $\M,\N\models \textrm{RG}$ and $\A\subset \M\cap \N$. Fix a q.f. formula $\phi(x_1,\dots,x_n,y)$ and $a_1,\dots,a_n\in A$. Assume $\M\models \phi(\bar{a},b)$ for some $b\in M$. Want to show that $\N\models \exists \phi(\bar{a},y)$.

Write $\phi(\bar{x},y)$ as $$\bigvee_{s=1}^{k}\bigwedge_{t=1}^{\ell_s}\theta_{s,t}(\bar{x},y)$$ where each $\theta_{s,t}$ is atomic or negated atomic (this is known as \textit{disjunctive normal form}). $\exists s\le k$ such that $$\M\models\bigwedge_{t=1}^{\ell_s}\theta_{s,t}(\bar{a},b)$$
Each $\theta_{s,t}$ is one of: $x_i = x_j, x_i = y,E(x_i,x_j),E(x_i,y)$, or the negation of one of the above. If we have $x_i = y$ appearing then $b = a_i\in A\subset N$. So $\N \models \phi(\bar{a},b)$ since $\phi$ is q.f.. We can assume that no $x_i = y$ appears. Let $X = \{a_i:\M\models E(a_i,b)\}$ and $Y = \{a_i : \M\models \neg E(a_i,b)\}$. $X$ and $Y$ are finite disjoint subsets of $A\subset N$. Choose $c\in N$ such that $\N\models E(a_i,c)$ iff $a_i \in X$, and $c\not\in\{a_1,\dots,a_n\}$. We do this by finding a new element connected to everything in $X$ and nothing in $Y$, and ensure that $c$ is not connected to this new vertex either.

Then $\N\models \bigwedge_{t}\theta_{s,t}(\bar{a},c)$ (check). So $\N\models \phi(\bar{a},c)$.
\end{proof}

\section{Types}

\underline{Motivation}: Given $\M$, we want to understand ``potential behaviour'' of elements in elementary extensions.

\underline{Terminology}: Given an $\L$-structure $\M$ and $A\subset M$, we call an $\L_A$-formula an \undf{$\L$-formula with parameters from $A$}. We write these as $\phi(\bar{x},\bar{a})$ where $\phi(\bar{x},\bar{y})$ is an $\L$-formula and $\bar{a}$ is from $A$. (Identifiy $a$ with $\underline{a}^\M$ - this should not cause problems in most cases).

Now suppose $\M$ is an $\L$-structure and $\N\succeq\M$. If $a\in N\backslash M$ then the $\L_N$-formula $x = a$ doescribes the new behvaiour in a trivial way.

OTOH: If $\phi(x)$ is an $\L$-formula with parameters from $\M$ and $\N\models \phi(a)$ for some $a\in N$, then $\N\models \exists x\phi(x)$ so $\M\models \exists \phi(x)$.

\underline{Idea}: New behaviour cannot be controlled with one formula at a time.

\underline{Notation}: Let $p$ be a set of formulas in free variables $x_1,\dots,x_n$. We also write $p(x_1,\dots,x_n)$. Given $\M$ and $a_1,\dots,a_n\in M$, we write $\M\models p(a_1,\dots,a_n)$ if $\M\models \phi(\bar{a})$ for all $\phi\in p$. We say ``$\bar{a}$ realises $p$ (in $\M$)''. Also write $\bar{a}\models p$. We call $p$ \undf{consistent} if it is realised in some structure.

\begin{remark*}[Exercise]
$p$ is consistent iff every finite subset of $p$ is consistent.
\end{remark*}

\begin{defin}[$n$-type]
Let $\M$ be an $\L$-structure and fix $A\subset M$. An \undf{$n$-type over $A$ w.r.t. $\M$} is a set $p$ of $\L$-formulae with parameters from $A$ in free variables $x_1,\dots,x_n$ such that $p\cup \Th(\M)$ is consistent.

We say $p$ is \undf{complete} if, for every $\L_A$-formula $\phi(x_1,\dots,x_n)$, either $\phi \in p$ or $\neg \phi \in p$.

Let $S_n^\M(A)$ denote the set of all complete $n$-types over $A$ w.r.t. $\M$.
\end{defin}

\begin{ex}
Given $a_1,\dots,a_n\in M$, let $\textrm{tp}^\M(a_1,\dots,a_n/A)$ be the set of all $\L_A$-formulae $\phi(x_1,\dots,x_n)$ such that $\M\models \phi(\bar{a})$. Then $\tp^\M(\bar{a}/A)\in S_n^\M(A)$, and $\bar{a}\models \tp^\M(\bar{a}/A)$.
\end{ex}
\begin{prop}
If $p \in S_n^\M(A)$, then there is $\N\succeq\M$ with $|N| \le |M| + |\L|$, and $\bar{a}\in N^n$ such that $p = \tp^\N(\bar{a}/A)$.
\end{prop}
\begin{proof}
By assumption, $p\cup\Th_A(\M)$ is consistent. We want to showt hat $p \cup \Th_M(\M)$ is consistent, which is not \it{quite} what we have.

Fix $\Sigma \subset p \cup \Th_M(\M)$ finite. So $\Sigma \subset p \cup \{\phi_1,\dots,\phi_t\}$ where $\phi_i$ is an $\L_M$-sentence, and $\M\models \phi_i$. Let $\phi^\ast$ be $\bigwedge_{i=1}^{t}\phi_i$. We can write $\phi^\ast$ as $\phi(\underline{b}_1,\dots,\underline{b}_m)$ where $b_1,\dots,b_m\in \M\backslash A$ and $\phi(x_1,\dots,x_n)$ is an $\L_A$-formula. Since $\M\models \phi(b_1,\dots,b_m)$, we have that $\M\models \exists \bar{v}\phi(v_1,\dots,v_m)$. So $\exists \bar{v}\phi(\bar{v})\in \Th_A(\M)$. Since $p\cup \Th_A(\M)$ is consistent, there is $\N\models \Th_A(\M)$ and $\bar{a} \in N^n$ such that $\N\models p(\bar{a})$.

Since $\N\models \exists \bar{v}\phi(\bar{v})$, there is $\bar{c} \in N^m$ such that $\N\models \phi(\bar{c})$. Expand $\N$ to an $\L_M$-structure such that $\underline{b}_i^\N = c_i$ and $\underline{b}^\N$ is arbitrary for $b\in M\backslash (A\cup \{b_1,\dots,b_m\})$. Then $\N\models \phi(\underline{b}_1,\dots,\underline{b}_m)$, \it{i.e.} $\N\models \phi^\ast$. So $\N\models \Sigma$.
\end{proof}


\end{document}